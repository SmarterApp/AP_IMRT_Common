package org.opentestsystem.ap.imrt.common.model;

import org.springframework.data.jpa.domain.support.AuditingEntityListener;

import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.EntityListeners;
import javax.persistence.Id;
import javax.persistence.JoinColumn;
import javax.persistence.ManyToOne;
import javax.persistence.OneToOne;
import javax.persistence.PrimaryKeyJoinColumn;
import javax.persistence.Table;
import javax.validation.constraints.NotNull;

/**
 * The linking between stimuli and the item
 */
@Entity
@Table(name = "stim_link")
@EntityListeners(AuditingEntityListener.class)
public class StimulusLink extends BaseEntity {
    @Id
    @Column(name = "item_key")
    private Integer itemKey;

    @NotNull
    @ManyToOne
    @JoinColumn(name = "item_key_stim")
    private Stimulus stimulus;

    @NotNull
    @OneToOne
    @PrimaryKeyJoinColumn(name = "item_key", referencedColumnName = "item_key")
    private ImrtItem item;

    /**
     * @param item     the {@link ImrtItem} containing the associated stimulus
     * @param stimulus the {@link Stimulus}
     */
    public StimulusLink(final ImrtItem item, final Stimulus stimulus, String updatedBy) {
        this.item = item;
        this.stimulus = stimulus;
        this.setUpdatedBy(updatedBy);
        this.itemKey = item.getKey();
    }

    public StimulusLink() {
    }

    /**
     * @return the {@link ImrtItem} that has a stim link
     */
    public ImrtItem getItem() {
        return item;
    }

    public void setItem(final ImrtItem item) {
        this.item = item;
        this.itemKey = item.getKey();
    }

    /**
     * @return the associated {@link Stimulus}
     */
    public Stimulus getStimulus() {
        return stimulus;
    }

    public void setStimulus(final Stimulus stimulus) {
        this.stimulus = stimulus;
    }

    int getItemKey() {
        return itemKey;
    }

    void setItemKey(final int itemKey) {
        this.itemKey = itemKey;
    }
}